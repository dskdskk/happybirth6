<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸“å±ç”Ÿæ—¥æƒŠå–œ</title>
    <!-- å¼•å…¥å­—ä½“å’Œå›¾æ ‡åº“ -->
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Pacifico&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- å¼•å…¥åŠ¨ç”»åº“ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        /* --- å…¨å±€å˜é‡ä¸é‡ç½® --- */
        :root {
            --primary: #ff6b6b;
            --accent: #feca57;
            --text-light: #fff;
            --bg-gradient: radial-gradient(circle at center, #2c3e50 0%, #000000 100%);
        }
        
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: 'Ma Shan Zheng', cursive, sans-serif;
            background: var(--bg-gradient);
            color: var(--text-light);
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* --- é€šç”¨ç»„ä»¶ --- */
        .hidden { display: none !important; }
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 50px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s;
            font-family: inherit;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { transform: scale(1.1); background: #ff4757; }

        /* --- ç¬¬ä¸€å…³ï¼šå¯†ç è§£é” --- */
        #stage-login {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: url('https://images.unsplash.com/photo-1492684223066-81342ee5ff30?q=80&w=1920&auto=format&fit=crop') no-repeat center/cover;
        }
        .login-box {
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.2);
            animation: fadeInDown 1s;
        }
        .login-input {
            padding: 10px;
            border-radius: 5px;
            border: none;
            margin: 20px 0;
            width: 80%;
            font-size: 1rem;
            text-align: center;
        }

        /* --- ç¬¬äºŒå…³ï¼šç¤¼ç‰©ç›’ä¸è®¡æ—¶ --- */
        #stage-gift {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        .timer-display {
            font-size: 1.5rem;
            margin-bottom: 50px;
            text-align: center;
            line-height: 1.5;
            text-shadow: 0 0 10px var(--primary);
        }
        
        /* 3D ç¤¼ç‰©ç›’ CSS */
        .gift-container {
            perspective: 1000px;
            cursor: pointer;
        }
        .gift-box {
            width: 150px; height: 150px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 1s;
            animation: floatBox 3s infinite ease-in-out;
        }
        .gift-box:hover { transform: rotateY(180deg); }
        .face {
            position: absolute; width: 150px; height: 150px;
            background: var(--primary);
            border: 2px solid #d63031;
        }
        .face.front { transform: translateZ(75px); }
        .face.back { transform: rotateY(180deg) translateZ(75px); }
        .face.right { transform: rotateY(90deg) translateZ(75px); }
        .face.left { transform: rotateY(-90deg) translateZ(75px); }
        .face.top { transform: rotateX(90deg) translateZ(75px); background: #ff7675; }
        .face.bottom { transform: rotateX(-90deg) translateZ(75px); }
        
        .ribbon {
            position: absolute; width: 30px; height: 150px;
            background: var(--accent);
            left: 60px;
        }
        .ribbon-h {
            position: absolute; width: 150px; height: 30px;
            background: var(--accent);
            top: 60px;
        }

        /* --- ç¬¬ä¸‰å…³ï¼šä¸»æ´¾å¯¹ --- */
        #stage-party {
            padding-bottom: 100px;
        }
        
        /* å¼¹å¹•å±‚ */
        #danmaku-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 1; overflow: hidden;
        }
        .danmaku-item {
            position: absolute; white-space: nowrap;
            font-size: 1.2rem; color: rgba(255,255,255,0.8);
            animation: moveLeft linear;
        }

        /* å†…å®¹åŒº */
        .content-wrapper {
            position: relative; z-index: 10;
            max-width: 800px; margin: 0 auto;
            text-align: center;
        }

        /* è›‹ç³• */
        .cake-section { margin: 50px 0; transform: scale(0.8); }
        /* å¤ç”¨ä¹‹å‰çš„è›‹ç³•CSSï¼Œå¾®è°ƒ */
        .cake { width: 250px; height: 200px; margin: 0 auto; position: relative;}
        .plate { width: 270px; height: 10px; background: #eee; position: absolute; bottom: -10px; left: -10px; border-radius: 10px; }
        .layer { position: absolute; width: 250px; height: 100px; border-radius: 10px 10px 0 0; }
        .layer-bottom { bottom: 0; background: #a37551; }
        .layer-middle { bottom: 50px; background: #f4c29f; height: 90px; width: 230px; left: 10px; }
        .layer-top { bottom: 100px; background: #ffccd5; height: 80px; width: 210px; left: 20px; border-radius: 50%; }
        .candle { width: 10px; height: 40px; background: #fff; position: absolute; top: -40px; left: 100px; }
        .flame { width: 15px; height: 20px; background: orange; border-radius: 50% 50% 20% 20%; position: absolute; top: -15px; left: -2.5px; animation: flicker 0.5s infinite; cursor: pointer; box-shadow: 0 0 10px orange; }

        /* ä¿¡çº¸ */
        .letter-box {
            background: url('https://www.transparenttextures.com/patterns/cream-paper.png'), #fff;
            color: #333;
            padding: 40px;
            margin: 20px;
            border-radius: 5px;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            font-size: 1.2rem;
            line-height: 1.8;
            text-align: left;
            position: relative;
        }
        .letter-box::before {
            content: ''; position: absolute; top: -10px; left: 50%; transform: translateX(-50%);
            width: 100px; height: 20px; background: rgba(255,255,255,0.3); transform: rotate(-2deg);
        }

        /* æ—¶é—´è½´ */
        .timeline {
            position: relative; margin: 50px 20px;
            border-left: 4px solid var(--primary);
            padding-left: 20px; text-align: left;
        }
        .timeline-item {
            margin-bottom: 40px; position: relative;
            background: rgba(255,255,255,0.1); padding: 20px;
            border-radius: 10px; border: 1px solid rgba(255,255,255,0.2);
        }
        .timeline-item::before {
            content: 'â¤'; position: absolute; left: -31px; top: 10px;
            background: var(--primary); width: 24px; height: 24px;
            border-radius: 50%; text-align: center; line-height: 24px;
        }
        .timeline-date { font-size: 0.9rem; color: var(--accent); margin-bottom: 5px; }
        .timeline-img { width: 100%; border-radius: 5px; margin-top: 10px; transition: transform 0.3s; }
        .timeline-img:hover { transform: scale(1.05); }

        /* è®¸æ„¿ç¯ */
        #wish-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); z-index: 200;
            display: flex; justify-content: center; align-items: center;
        }
        .wish-card {
            background: #fff; color: #333; padding: 30px;
            border-radius: 15px; width: 90%; max-width: 400px;
            text-align: center;
        }
        .wish-input {
            width: 100%; height: 100px; padding: 10px;
            margin: 20px 0; border: 1px solid #ccc;
        }

        /* éŸ³ä¹æ§åˆ¶ */
        .music-btn {
            position: fixed; top: 20px; right: 20px; z-index: 100;
            background: rgba(0,0,0,0.5); color: #fff;
            width: 40px; height: 40px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; border: 1px solid #fff;
        }
        .spin { animation: rotate 4s linear infinite; }

        /* åŠ¨ç”» Keyframes */
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes floatBox { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }
        @keyframes rotate { to { transform: rotate(360deg); } }
        @keyframes flicker { 0%, 100% { opacity: 1; } 50% { opacity: 0.8; transform: scale(1.1); } }
        @keyframes moveLeft { from { transform: translateX(100vw); } to { transform: translateX(-100%); } }
        @keyframes flyUp { 0% { bottom: 0; opacity: 1; } 100% { bottom: 100vh; opacity: 0; } }

        .lantern {
            position: absolute; width: 30px; height: 40px; background: red;
            border-radius: 5px; animation: flyUp 10s linear forwards;
        }

    </style>
</head>
<body>

    <!-- èƒŒæ™¯éŸ³ä¹ -->
    <audio id="bgm" loop>
        <source src="https://dl.dropboxusercontent.com/s/h8oc07r7680e30m/Happy%20Birthday.mp3" type="audio/mpeg">
    </audio>
    <div class="music-btn" onclick="toggleMusic()"><i class="fas fa-music"></i></div>

    <!-- å¼¹å¹•å®¹å™¨ -->
    <div id="danmaku-container"></div>

    <!-- === ç¬¬ä¸€å…³ï¼šå¯†ç  === -->
    <div id="stage-login">
        <div class="login-box">
            <h2>âœ¨ å¯¿æ˜ŸéªŒè¯ âœ¨</h2>
            <p>è¯·è¾“å…¥ä½ çš„åå­—ï¼ˆæˆ–æ˜µç§°ï¼‰å¼€å¯</p>
            <!-- è¿™é‡Œè®¾ç½®å¯†ç é€»è¾‘ï¼Œé»˜è®¤ä¸º 'å°å¯çˆ±' -->
            <input type="text" id="password-input" class="login-input" placeholder="æˆ‘æ˜¯è°ï¼Ÿ">
            <button class="btn btn-primary" onclick="checkPasscode()">ç¡®è®¤</button>
            <p id="error-msg" style="color: #ff6b6b; margin-top: 10px; display: none;">ä¸å¯¹å“¦ï¼Œå†è¯•è¯•~</p>
        </div>
    </div>

    <!-- === ç¬¬äºŒå…³ï¼šç¤¼ç‰©ä¸æ—¶é—´ === -->
    <div id="stage-gift" class="hidden">
        <div class="timer-display" id="timer"></div>
        <div class="gift-container" onclick="openGift()">
            <div class="gift-box">
                <div class="face front"></div>
                <div class="face back"></div>
                <div class="face right"></div>
                <div class="face left"></div>
                <div class="face top"></div>
                <div class="face bottom"></div>
                <div class="ribbon"></div>
                <div class="ribbon-h"></div>
            </div>
        </div>
        <p style="margin-top: 30px; animation: pulse 1s infinite;">ğŸ‘† ç‚¹å‡»æ‹†å¼€ç¤¼ç‰© ğŸ‘†</p>
    </div>

    <!-- === ç¬¬ä¸‰å…³ï¼šæ´¾å¯¹ä¸»åœº === -->
    <div id="stage-party" class="hidden animate__animated animate__fadeIn">
        <div class="content-wrapper">
            <h1 class="animate__animated animate__bounceInDown" style="font-family: 'Pacifico'; font-size: 3.5rem; margin-top: 30px;">Happy Birthday!</h1>
            
            <!-- è›‹ç³• -->
            <div class="cake-section">
                <div class="cake">
                    <div class="plate"></div>
                    <div class="layer layer-bottom"></div>
                    <div class="layer layer-middle"></div>
                    <div class="layer layer-top"></div>
                    <div class="candle">
                        <div class="flame" id="flame" onclick="blowCandle()"></div>
                    </div>
                </div>
                <p style="margin-top: 10px; color: #ddd;">( ç‚¹å‡»ç«ç„°å¹ç­èœ¡çƒ› )</p>
            </div>

            <!-- ä¿¡ä»¶ -->
            <div class="letter-box">
                <span id="typewriter-text"></span>
            </div>

            <!-- æ—¶é—´è½´ (ç…§ç‰‡å¢™å‡çº§ç‰ˆ) -->
            <div class="timeline">
                <h2 style="text-align: center; margin-bottom: 30px;">ğŸ•°ï¸ æˆ‘ä»¬çš„æ—¶å…‰å°è®°</h2>
                
                <!-- æ—¶é—´èŠ‚ç‚¹ 1 -->
                <div class="timeline-item">
                    <div class="timeline-date">2020å¹´5æœˆ20æ—¥</div>
                    <h3>åˆæ¬¡ç›¸é‡</h3>
                    <p>é‚£æ˜¯ä¸€ä¸ªé˜³å…‰æ˜åªšçš„ä¸‹åˆï¼Œæˆ‘ä»¬åœ¨å›¾ä¹¦é¦†é—¨å£...</p>
                    <img src="https://via.placeholder.com/400x200/ff6b6b/fff?text=Meeting" class="timeline-img" alt="ç›¸é‡">
                </div>
                
                <!-- æ—¶é—´èŠ‚ç‚¹ 2 -->
                <div class="timeline-item">
                    <div class="timeline-date">2021å¹´1æœˆ1æ—¥</div>
                    <h3>ä¸€èµ·è·¨å¹´</h3>
                    <p>çƒŸèŠ±ä¸‹çš„ä½ ç¬‘å¾—æ¯”çƒŸèŠ±è¿˜å¥½çœ‹ã€‚</p>
                    <img src="https://via.placeholder.com/400x200/feca57/fff?text=New+Year" class="timeline-img" alt="è·¨å¹´">
                </div>
                 <!-- æ—¶é—´èŠ‚ç‚¹ 3 -->
                 <div class="timeline-item">
                    <div class="timeline-date">2023å¹´ ç”Ÿæ—¥</div>
                    <h3>å»å¹´çš„ç”Ÿæ—¥</h3>
                    <p>è¿˜æ˜¯é‚£ä¸ªè›‹ç³•ï¼Œè¿˜æ˜¯é‚£ä¸ªæ„¿æœ›ã€‚</p>
                    <img src="https://via.placeholder.com/400x200/54a0ff/fff?text=Last+Birthday" class="timeline-img" alt="ç”Ÿæ—¥">
                </div>
            </div>

            <!-- åº•éƒ¨æŒ‰é’® -->
            <button class="btn btn-primary" onclick="showWishModal()">âœ¨ æˆ‘è¦è®¸æ„¿ âœ¨</button>
        </div>
    </div>

    <!-- è®¸æ„¿å¼¹çª— -->
    <div id="wish-modal" class="hidden">
        <div class="wish-card animate__animated animate__zoomIn">
            <h3>è®¸ä¸‹ä»Šå¹´çš„æ„¿æœ›</h3>
            <textarea class="wish-input" id="wish-text" placeholder="åœ¨è¿™é‡Œå†™ä¸‹æ„¿æœ›..."></textarea>
            <button class="btn btn-primary" onclick="submitWish()">å‘é€æ„¿æœ› ğŸˆ</button>
            <button class="btn" style="background: #ccc; margin-left: 10px;" onclick="closeWishModal()">å…³é—­</button>
        </div>
    </div>

    <script>
        /* === é…ç½®åŒºåŸŸ (è¯·åœ¨è¿™é‡Œä¿®æ”¹) === */
        const config = {
            // 1. ç™»å½•å¯†ç  (å¡«è¿™é‡Œ)
            correctPassword: "å°å¯çˆ±",
            
            // 2. ä½ ä»¬çš„å¼€å§‹æ—¶é—´ (æ ¼å¼ï¼šYYYY-MM-DD)
            startDate: "2000-01-01", 
            
            // 3. ä¿¡ä»¶å†…å®¹ (æ”¯æŒHTML)
            letter: `äº²çˆ±çš„ [åå­—]ï¼š<br><br>
            è¿™æ˜¯æˆ‘ä»¬è®¤è¯†çš„ç¬¬ N ä¸ªå¹´å¤´äº†ã€‚<br>
            çœ‹ç€è¿™äº›ç…§ç‰‡ï¼Œä»¿ä½›æ˜¨å¤©æ‰åˆšåˆšå‘ç”Ÿã€‚<br>
            <br>
            æ„¿ä½ çš„ç”Ÿæ´»æ¯å¤©éƒ½åƒä»Šå¤©çš„è›‹ç³•ä¸€æ ·ç”œã€‚<br>
            æ„¿ä½ åœ¨æœªæ¥çš„æ—¥å­é‡Œï¼Œ<br>
            çœ¼é‡Œæœ‰å…‰ï¼Œå¿ƒä¸­æœ‰çˆ±ã€‚<br>
            <br>
            ç”Ÿæ—¥å¿«ä¹ï¼ğŸ‚<br>
            -- çˆ±ä½ çš„ [ä½ çš„åå­—]`,

            // 4. å¼¹å¹•å†…å®¹åº“
            danmakuText: [
                "ç”Ÿæ—¥å¿«ä¹ï¼ğŸ‚", "æ°¸è¿œ18å²ï¼âœ¨", "å¤©å¤©å¼€å¿ƒï¼ğŸ˜„", 
                "æš´å¯Œæš´ç˜¦ï¼ğŸ’°", "å¿ƒæƒ³äº‹æˆï¼ğŸŒŸ", "é¢œå€¼çˆ†è¡¨ï¼ğŸ˜", 
                "ä¸‡äº‹å¦‚æ„ï¼ğŸ‰", "å‰ç¨‹ä¼¼é”¦ï¼ğŸš€"
            ]
        };

        /* === é€»è¾‘åŒºåŸŸ === */
        const bgm = document.getElementById('bgm');
        let musicPlaying = false;

        // 1. å¯†ç æ£€æŸ¥
        function checkPasscode() {
            const input = document.getElementById('password-input').value;
            if (input === config.correctPassword) {
                document.getElementById('stage-login').classList.add('hidden');
                document.getElementById('stage-gift').classList.remove('hidden');
                initTimer();
            } else {
                document.getElementById('error-msg').style.display = 'block';
                // éœ‡åŠ¨æ•ˆæœ
                document.querySelector('.login-box').classList.add('animate__shakeX');
                setTimeout(() => document.querySelector('.login-box').classList.remove('animate__shakeX'), 1000);
            }
        }

        // 2. è®¡æ—¶å™¨
        function initTimer() {
            const start = new Date(config.startDate);
            setInterval(() => {
                const now = new Date();
                const diff = now - start;
                
                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const seconds = Math.floor((diff % (1000 * 60)) / 1000);

                document.getElementById('timer').innerHTML = 
                    `æˆ‘ä»¬å·²ç»ç›¸è¯†äº†ï¼š<br>
                    <span style="font-size: 3rem; color: var(--primary)">${days}</span> å¤© 
                    <span style="font-size: 2rem">${hours}</span> å°æ—¶ 
                    <span style="font-size: 2rem">${seconds}</span> ç§’`;
            }, 1000);
        }

        // 3. å¼€ç¤¼ç‰©
        function openGift() {
            toggleMusic(); // å°è¯•æ’­æ”¾éŸ³ä¹
            confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
            
            document.querySelector('.gift-box').style.transform = "scale(5) rotateY(180deg)";
            document.querySelector('.gift-box').style.opacity = "0";
            
            setTimeout(() => {
                document.getElementById('stage-gift').classList.add('hidden');
                document.getElementById('stage-party').classList.remove('hidden');
                initDanmaku();
                typeWriter(config.letter, 0);
            }, 800);
        }

        // 4. å¹èœ¡çƒ›
        function blowCandle() {
            document.getElementById('flame').style.opacity = 0;
            confetti({ particleCount: 300, spread: 100, origin: { y: 0.6 } });
            alert("ğŸ‰ æ„¿æœ›å·²è®¸ä¸‹ï¼Œç”Ÿæ—¥å¿«ä¹ï¼");
        }

        // 5. è®¸æ„¿é€»è¾‘
        function showWishModal() { document.getElementById('wish-modal').classList.remove('hidden'); }
        function closeWishModal() { document.getElementById('wish-modal').classList.add('hidden'); }
        
        function submitWish() {
            const text = document.getElementById('wish-text').value;
            if(text) {
                closeWishModal();
                // åˆ›å»ºæ”¾é£çš„æ°”çƒ/ç¯ç¬¼æ•ˆæœ
                const lantern = document.createElement('div');
                lantern.className = 'lantern';
                lantern.style.left = Math.random() * 80 + 10 + '%';
                lantern.innerText = 'ğŸ®'; // å¯ä»¥æ¢æˆå›¾ç‰‡
                lantern.style.fontSize = '30px';
                lantern.style.background = 'transparent';
                document.body.appendChild(lantern);
                
                setTimeout(() => lantern.remove(), 10000);
                alert("æ„¿æœ›å·²é£å‘äº‘ç«¯ï¼â˜ï¸");
            }
        }

        // 6. æ‰“å­—æœº
        function typeWriter(text, i) {
            const el = document.getElementById('typewriter-text');
            if (i < text.length) {
                el.innerHTML = text.substring(0, i+1);
                setTimeout(() => typeWriter(text, i + 1), 50);
            }
        }

        // 7. å¼¹å¹•ç³»ç»Ÿ
        function initDanmaku() {
            const container = document.getElementById('danmaku-container');
            setInterval(() => {
                const item = document.createElement('div');
                item.className = 'danmaku-item';
                item.innerText = config.danmakuText[Math.floor(Math.random() * config.danmakuText.length)];
                item.style.top = Math.random() * 80 + '%';
                item.style.animationDuration = (Math.random() * 5 + 5) + 's';
                container.appendChild(item);
                
                // åŠ¨ç”»ç»“æŸåç§»é™¤
                item.addEventListener('animationend', () => item.remove());
            }, 1500);
        }

        // éŸ³ä¹æ§åˆ¶
        function toggleMusic() {
            if (bgm.paused) {
                bgm.play();
                document.querySelector('.music-btn').classList.add('spin');
            } else {
                bgm.pause();
                document.querySelector('.music-btn').classList.remove('spin');
            }
        }
    </script>
</body>
</html>
